
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Ollivander</title>
  <meta name="author" content="Alan Franzoni">

  
  <meta name="description" content="UPDATE:Most of this is pointless on IDEA &gt;= 11 and PyCharm &gt;= 2, since a Tools -&gt; Create desktop entry menu now exists and will let you do &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ollivander.franzoni.eu/blog/page/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Ollivander" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-32820324-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Ollivander</a></h1>
  
    <h2>A wand is not enough</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ollivander.franzoni.eu" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/12/07/jetbrains-ides-dock-aware-launcher-for-linux/">Jetbrains IDEs: Dock-aware Launcher for Linux</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-12-07T20:24:00+01:00" pubdate data-updated="true">Dec 7<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<b>UPDATE:</b><br />Most of this is pointless on IDEA &gt;= 11 and PyCharm &gt;= 2, since a <i>Tools -&gt; Create desktop entry </i>menu now exists and will let you do everything my launcher did. You&#8217;ll need to reinstall it at every update - or just use the symlink trick I reccomended with the&nbsp;<a href="https://github.com/alanfranz/jb_ide_launcher/" target="_blank">standalone launcher</a>&nbsp;and edit the IDEA desktop entry.<br /><br />I had<a href="http://ollivander.franzoni.eu/2011/02/pycharm-and-rubymine-linux-desktop.html" target="_blank"> already elaborated</a> on this, and I still thank <a href="http://blog.dutchworks.nl/2011/01/09/make-intellij-idea-behave-properly-in-linux-docks/" target="_blank">Dutchworks</a>&nbsp;for their work, but I was yet to be satisfied with the status of dock awareness for Jetbrains IDEs; I tend to use multiple of those and I was highly dissatisfied with the way the dock grouped all my Java apps - that&#8217;s caused by the fact that many Java apps based on Swing/AWT share the same WM_CLASS attribute, which is used bye the dock to tell one window from another - but you can read more on that from the Dutchworks blog page above.<br /><br />The basic problem is:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://github.com/alanfranz/jb_ide_launcher/raw/master/screenshot-problem.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="345" src="https://github.com/alanfranz/jb_ide_launcher/raw/master/screenshot-problem.jpg" width="640" /></a></div><br />Here I have launched IDEA and PyCharm at the same time, and they&#8217;re grouped with the very same icon by <a href="http://do.davebsd.com/wiki/Docky" target="_blank">docky</a> - you need to right-click the icon and pick the proper subwindow, which is quite an hassle.<br /><br />My previously created solution required to update the launcher and copy agent.jar at every update.<br /><br />So what?<br /><br />I just created a <a href="https://github.com/alanfranz/jb_ide_launcher/" target="_blank">standalone launcher</a>&nbsp;which creates a proper .desktop file in your .local/share/applications directory, does not modify original files and still allows IDEs to have their own distinct icon in the dock:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://github.com/alanfranz/jb_ide_launcher/raw/master/screenshot-solved.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="314" src="https://github.com/alanfranz/jb_ide_launcher/raw/master/screenshot-solved.jpg" width="640" /></a></div><br /><br />There I have both IDEA and PyCharm active at the same time, and they both work properly, and, whenever updating, you can just update the symlink (as suggested in the README from the GitHub repo) and you&#8217;re done!<br /><br />Multiple projects in the same DIE still share the same icon, but that doesn&#8217;t seem to be changeable from the outside, it&#8217;s something that Jetbrains should do; I&#8217;ll open a ticket for that.<br /><br />Enjoy!<br /><br /><br /></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/10/20/deploy-any-java-webapp-via-war-to-heroku/">Deploy Any Java Webapp via War to Heroku</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-10-20T23:17:00+02:00" pubdate data-updated="true">Oct 20<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
<a href="http://www.heroku.com/java">Heroku Java</a> support is something I longed for, but they <a href="http://devcenter.heroku.com/articles/java-faq#can_i_deploy_an_application_packaged_as_a_war_file_to_heroku">apparently don&#8217;t support</a> deploying a plain, old war file to Heroku.  <br /><br />I don&#8217;t like that; I&#8217;ve got my own continuous integration setup, and I want to compile my files on my own box - this allows me to keep my own Maven proxy with my own dependencies - which sometimes are patched versions of public ones - &nbsp;so that I don&#8217;t need to push everything on a public repo. I don&#8217;t want to be forced to build everything on Heroku, and I don&#8217;t want to compile anything I push - I&#8217;d usually push to Heroku stable versions only, or maybe integration versions that pass unit, integration and acceptance tests.<br /><br />So what? Don&#8217;t worry, deployment is possible.<br /><br /><script src="https://gist.github.com/1301100.js"> </script><br/><br/>Setup an heroku-aware git repository and a <a href="http://devcenter.heroku.com/articles/java">Cedar stack app,</a> and add the files you see above; your dir structure should look like:<br /><br /><blockquote>pom.xml<br />Procfile<br />src/<br />&nbsp; &nbsp; &nbsp;main/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;java/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;StartWebApp.java<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;resources/<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mywebapp.war</blockquote><br /><br />Now a simple<br /><br /><blockquote>git push heroku master</blockquote><br /><br />Should do the trick, and let you see your fully deployed war app.<br /><br /><br />There&#8217;re still things you need to be aware of; file persistence may not work as expected, since filesystem is ephemeral, and I still need to figure out things related to database configuration, but those should not come at a great expense.<br /><br />I&#8217;ll post updates in the future as soon as I get them right.<br /><br /><br /><br /></div>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/08/30/mock-javamail-primer/">Mock Javamail Primer</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-08-30T21:46:00+02:00" pubdate data-updated="true">Aug 30<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class='post'>
Small primer for mock javamail, a pretty useful project that will be handy whenever you need to test code that uses POP3/IMAP/SMTP and you wouldn&#8217;t like to build wrappers for anything you need to test - javamail does not really offer interfaces that can be implemented by mock objects, but different implementations can be used at runtime depending on which jars are on the classpath.<br /><br />Take a look at the project homepage:<br /><br /><a href="http://java.net/projects/mock-javamail">http://java.net/projects/mock-javamail</a><br /><br />Be sure you&#8217;ve enabled java.net Maven repo, and add this dependency to your pom.xml:<br /><br /><pre style="background-color: #002b36; border-color: #000000; border-style: solid; border-width: 0.01mm; font-family: monospace; font-size: 13pt; line-height: 100%; padding: 4px;"><span style="background-color: #073642; color: #586e75;">1 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #586e75;">&lt;</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">dependency</span><span style="background-color: #002b36; color: #586e75;">&gt;
<br /></span><span style="background-color: #073642; color: #586e75;">2 </span><span style="background-color: #002b36; color: #839496;">            </span><span style="background-color: #002b36; color: #586e75;">&lt;</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">groupId</span><span style="background-color: #002b36; color: #586e75;">&gt;</span><span style="background-color: #002b36; color: #839496;">org.jvnet.mock-javamail</span><span style="background-color: #002b36; color: #586e75;">&lt;/</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">groupId</span><span style="background-color: #002b36; color: #586e75;">&gt;
<br /></span><span style="background-color: #073642; color: #586e75;">3 </span><span style="background-color: #002b36; color: #839496;">            </span><span style="background-color: #002b36; color: #586e75;">&lt;</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">artifactId</span><span style="background-color: #002b36; color: #586e75;">&gt;</span><span style="background-color: #002b36; color: #839496;">mock-javamail</span><span style="background-color: #002b36; color: #586e75;">&lt;/</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">artifactId</span><span style="background-color: #002b36; color: #586e75;">&gt;
<br /></span><span style="background-color: #073642; color: #586e75;">4 </span><span style="background-color: #002b36; color: #839496;">            </span><span style="background-color: #002b36; color: #586e75;">&lt;</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">version</span><span style="background-color: #002b36; color: #586e75;">&gt;</span><span style="background-color: #002b36; color: #839496;">1.9</span><span style="background-color: #002b36; color: #586e75;">&lt;/</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">version</span><span style="background-color: #002b36; color: #586e75;">&gt;
<br /></span><span style="background-color: #073642; color: #586e75;">5 </span><span style="background-color: #002b36; color: #839496;">            </span><span style="background-color: #002b36; color: #586e75;">&lt;</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">scope</span><span style="background-color: #002b36; color: #586e75;">&gt;</span><span style="background-color: #002b36; color: #839496;">test</span><span style="background-color: #002b36; color: #586e75;">&lt;/</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">scope</span><span style="background-color: #002b36; color: #586e75;">&gt;
<br /></span><span style="background-color: #073642; color: #586e75;">6 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #586e75;">&lt;/</span><span style="background-color: #002b36; color: #268bd2; font-weight: bold;">dependency</span><span style="background-color: #002b36; color: #586e75;">&gt;</span></pre><br />You&#8217;re almost ready; now setup your test code this way:<br /><br /><pre style="background-color: #002b36; border-color: #000000; border-style: solid; border-width: 0.01mm; font-family: monospace; font-size: 13pt; line-height: 100%; padding: 4px;"><span style="background-color: #073642; color: #586e75;"> 1 </span><span style="background-color: #002b36; color: #b58900;">public</span><span style="background-color: #002b36; color: #839496;"> </span><span style="background-color: #002b36; color: #b58900;">class</span><span style="background-color: #002b36; color: #839496;"> IMAPMailRepositoryTest {
<br /></span><span style="background-color: #073642; color: #586e75;"> 2 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #859900;">@Before
<br /></span><span style="background-color: #073642; color: #586e75;"> 3 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #b58900;">public</span><span style="background-color: #002b36; color: #839496;"> </span><span style="background-color: #002b36; color: #b58900;">void</span><span style="background-color: #002b36; color: #839496;"> setUp() </span><span style="background-color: #002b36; color: #b58900;">throws</span><span style="background-color: #002b36; color: #839496;"> Exception {
<br /></span><span style="background-color: #073642; color: #586e75;"> 4 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #b58900;">final</span><span style="background-color: #002b36; color: #839496;"> Session session = Session.getInstance(
<br /></span><span style="background-color: #073642; color: #586e75;"> 5 </span><span style="background-color: #002b36; color: #839496;">                System.getProperties());
<br /></span><span style="background-color: #073642; color: #586e75;"> 6 
<br /> 7 </span><span style="background-color: #002b36; color: #839496;">        MimeMessage msg = </span><span style="background-color: #002b36; color: #b58900;">new</span><span style="background-color: #002b36; color: #839496;"> MimeMessage(
<br /></span><span style="background-color: #073642; color: #586e75;"> 8 </span><span style="background-color: #002b36; color: #839496;">                session);
<br /></span><span style="background-color: #073642; color: #586e75;"> 9 </span><span style="background-color: #002b36; color: #839496;">        msg.setRecipients(Message.RecipientType.</span><span style="background-color: #002b36; color: #d33682;">TO</span><span style="background-color: #002b36; color: #839496;">,
<br /></span><span style="background-color: #073642; color: #586e75;">10 </span><span style="background-color: #002b36; color: #839496;">                </span><span style="background-color: #002b36; color: #2aa198;">"testuser@mockserver.com"</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">11 </span><span style="background-color: #002b36; color: #839496;">        msg.setSubject(</span><span style="background-color: #002b36; color: #2aa198;">"Some Subject"</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">12 </span><span style="background-color: #002b36; color: #839496;">        msg.setText(</span><span style="background-color: #002b36; color: #2aa198;">"sometext"</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">13 </span><span style="background-color: #002b36; color: #839496;">        Transport.send(msg);
<br /></span><span style="background-color: #073642; color: #586e75;">14 </span><span style="background-color: #002b36; color: #839496;">    }
<br /></span><span style="background-color: #073642; color: #586e75;">15 
<br />16 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #859900;">@After
<br /></span><span style="background-color: #073642; color: #586e75;">17 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #b58900;">public</span><span style="background-color: #002b36; color: #839496;"> </span><span style="background-color: #002b36; color: #b58900;">void</span><span style="background-color: #002b36; color: #839496;"> tearDown() </span><span style="background-color: #002b36; color: #b58900;">throws</span><span style="background-color: #002b36; color: #839496;"> Exception {
<br /></span><span style="background-color: #073642; color: #586e75;">18 </span><span style="background-color: #002b36; color: #839496;">        Mailbox.clearAll();
<br /></span><span style="background-color: #073642; color: #586e75;">19 </span><span style="background-color: #002b36; color: #839496;">    }</span></pre><br /><br /><br />Now you&#8217;re ready to use your mock javamail:<br /><br /><pre style="background-color: #002b36; border-color: #000000; border-style: solid; border-width: 0.01mm; font-family: monospace; font-size: 13pt; line-height: 100%; padding: 4px;"><span style="background-color: #073642; color: #586e75;"> 1 </span><span style="background-color: #002b36; color: #b58900;">public</span><span style="background-color: #002b36; color: #839496;"> </span><span style="background-color: #002b36; color: #b58900;">class</span><span style="background-color: #002b36; color: #839496;"> SomeImapClient {
<br /></span><span style="background-color: #073642; color: #586e75;"> 2 
<br /> 3 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #b58900;">private</span><span style="background-color: #002b36; color: #839496;"> </span><span style="background-color: #002b36; color: #b58900;">static</span><span style="background-color: #002b36; color: #839496;"> Logger </span><span style="background-color: #002b36; color: #d33682;">log</span><span style="background-color: #002b36; color: #839496;"> = Logger.getLogger(SomeImapClient.</span><span style="background-color: #002b36; color: #b58900;">class</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;"> 4 
<br /> 5 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #b58900;">public</span><span style="background-color: #002b36; color: #839496;"> </span><span style="background-color: #002b36; color: #b58900;">void</span><span style="background-color: #002b36; color: #839496;"> processMail() {
<br /></span><span style="background-color: #073642; color: #586e75;"> 6 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #b58900;">try</span><span style="background-color: #002b36; color: #839496;"> {
<br /></span><span style="background-color: #073642; color: #586e75;"> 7 </span><span style="background-color: #002b36; color: #839496;">            Session session = getMailSession();
<br /></span><span style="background-color: #073642; color: #586e75;"> 8 </span><span style="background-color: #002b36; color: #839496;">            Store store = connect(session);
<br /></span><span style="background-color: #073642; color: #586e75;"> 9 </span><span style="background-color: #002b36; color: #839496;">            Folder folder = openMailFolder(store);
<br /></span><span style="background-color: #073642; color: #586e75;">10 </span><span style="background-color: #002b36; color: #839496;">            findContent(folder);
<br /></span><span style="background-color: #073642; color: #586e75;">11 </span><span style="background-color: #002b36; color: #839496;">        } </span><span style="background-color: #002b36; color: #b58900;">catch</span><span style="background-color: #002b36; color: #839496;"> (MessagingException e) {
<br /></span><span style="background-color: #073642; color: #586e75;">12 </span><span style="background-color: #002b36; color: #839496;">            </span><span style="background-color: #002b36; color: #b58900;">throw</span><span style="background-color: #002b36; color: #839496;"> </span><span style="background-color: #002b36; color: #b58900;">new</span><span style="background-color: #002b36; color: #839496;"> RuntimeException(e);
<br /></span><span style="background-color: #073642; color: #586e75;">13 </span><span style="background-color: #002b36; color: #839496;">        } </span><span style="background-color: #002b36; color: #b58900;">catch</span><span style="background-color: #002b36; color: #839496;"> (IOException e) {
<br /></span><span style="background-color: #073642; color: #586e75;">14 </span><span style="background-color: #002b36; color: #839496;">            </span><span style="background-color: #002b36; color: #b58900;">throw</span><span style="background-color: #002b36; color: #839496;"> </span><span style="background-color: #002b36; color: #b58900;">new</span><span style="background-color: #002b36; color: #839496;"> RuntimeException(e);
<br /></span><span style="background-color: #073642; color: #586e75;">15 </span><span style="background-color: #002b36; color: #839496;">        }
<br /></span><span style="background-color: #073642; color: #586e75;">16 
<br />17 </span><span style="background-color: #002b36; color: #839496;">    }
<br /></span><span style="background-color: #073642; color: #586e75;">18 
<br />19 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #b58900;">public</span><span style="background-color: #002b36; color: #839496;"> Session getMailSession() {
<br /></span><span style="background-color: #073642; color: #586e75;">20 </span><span style="background-color: #002b36; color: #839496;">        Properties props = System.getProperties();
<br /></span><span style="background-color: #073642; color: #586e75;">21 </span><span style="background-color: #002b36; color: #839496;">        props.setProperty(</span><span style="background-color: #002b36; color: #2aa198;">"mail.store.protocol"</span><span style="background-color: #002b36; color: #839496;">, </span><span style="background-color: #002b36; color: #2aa198;">"imaps"</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">22 </span><span style="background-color: #002b36; color: #839496;">        props.setProperty(</span><span style="background-color: #002b36; color: #2aa198;">"mail.imap.partialfetch"</span><span style="background-color: #002b36; color: #839496;">, </span><span style="background-color: #002b36; color: #2aa198;">"0"</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">23 
<br />24 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #d33682;">log</span><span style="background-color: #002b36; color: #839496;">.debug(</span><span style="background-color: #002b36; color: #2aa198;">"Getting session"</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">25 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #b58900;">return</span><span style="background-color: #002b36; color: #839496;"> Session.getDefaultInstance(props, </span><span style="background-color: #002b36; color: #b58900;">null</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">26 
<br />27 </span><span style="background-color: #002b36; color: #839496;">    }
<br /></span><span style="background-color: #073642; color: #586e75;">28 
<br />29 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #b58900;">public</span><span style="background-color: #002b36; color: #839496;"> Store connect(Session session) </span><span style="background-color: #002b36; color: #b58900;">throws</span><span style="background-color: #002b36; color: #839496;"> MessagingException {
<br /></span><span style="background-color: #073642; color: #586e75;">30 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #d33682;">log</span><span style="background-color: #002b36; color: #839496;">.debug(</span><span style="background-color: #002b36; color: #2aa198;">"getting the session for accessing email."</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">31 </span><span style="background-color: #002b36; color: #839496;">        Store store = session.getStore(</span><span style="background-color: #002b36; color: #2aa198;">"imap"</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">32 
<br />33 </span><span style="background-color: #002b36; color: #839496;">        store.connect(</span><span style="background-color: #002b36; color: #2aa198;">"mockserver.com"</span><span style="background-color: #002b36; color: #839496;">, </span><span style="background-color: #002b36; color: #2aa198;">"testuser"</span><span style="background-color: #002b36; color: #839496;">, </span><span style="background-color: #002b36; color: #2aa198;">"somepassword"</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">34 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #d33682;">log</span><span style="background-color: #002b36; color: #839496;">.debug(</span><span style="background-color: #002b36; color: #2aa198;">"Connection established with IMAP server."</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">35 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #b58900;">return</span><span style="background-color: #002b36; color: #839496;"> store;
<br /></span><span style="background-color: #073642; color: #586e75;">36 </span><span style="background-color: #002b36; color: #839496;">    }
<br /></span><span style="background-color: #073642; color: #586e75;">37 
<br />38 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #b58900;">public</span><span style="background-color: #002b36; color: #839496;"> Folder openMailFolder(Store store) </span><span style="background-color: #002b36; color: #b58900;">throws</span><span style="background-color: #002b36; color: #839496;"> MessagingException {
<br /></span><span style="background-color: #073642; color: #586e75;">39 </span><span style="background-color: #002b36; color: #839496;">        Folder folder = store.getDefaultFolder();
<br /></span><span style="background-color: #073642; color: #586e75;">40 </span><span style="background-color: #002b36; color: #839496;">        folder = folder.getFolder(</span><span style="background-color: #002b36; color: #2aa198;">"inbox"</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">41 </span><span style="background-color: #002b36; color: #839496;">        folder.open(Folder.</span><span style="background-color: #002b36; color: #d33682;">READ_ONLY</span><span style="background-color: #002b36; color: #839496;">);
<br /></span><span style="background-color: #073642; color: #586e75;">42 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #b58900;">return</span><span style="background-color: #002b36; color: #839496;"> folder;
<br /></span><span style="background-color: #073642; color: #586e75;">43 </span><span style="background-color: #002b36; color: #839496;">    }
<br /></span><span style="background-color: #073642; color: #586e75;">44 
<br />45 </span><span style="background-color: #002b36; color: #839496;">    </span><span style="background-color: #002b36; color: #b58900;">public</span><span style="background-color: #002b36; color: #839496;"> </span><span style="background-color: #002b36; color: #b58900;">void</span><span style="background-color: #002b36; color: #839496;"> findContent(Folder folder) </span><span style="background-color: #002b36; color: #b58900;">throws</span><span style="background-color: #002b36; color: #839496;"> MessagingException, IOException {
<br /></span><span style="background-color: #073642; color: #586e75;">46 </span><span style="background-color: #002b36; color: #839496;">        </span><span style="background-color: #002b36; color: #b58900;">for</span><span style="background-color: #002b36; color: #839496;"> (Message m : folder.getMessages()) {
<br /></span><span style="background-color: #073642; color: #586e75;">47 </span><span style="background-color: #002b36; color: #839496;">            </span><span style="background-color: #002b36; color: #d33682;">log</span><span style="background-color: #002b36; color: #839496;">.debug(m.getSubject());
<br /></span><span style="background-color: #073642; color: #586e75;">48 
<br />49 </span><span style="background-color: #002b36; color: #839496;">        }
<br /></span><span style="background-color: #073642; color: #586e75;">50 
<br />51 
<br />52 </span><span style="background-color: #002b36; color: #839496;">    }
<br /></span><span style="background-color: #073642; color: #586e75;">53 
<br />54 
<br />55 </span><span style="background-color: #002b36; color: #839496;">}</span></pre><br /><br />Output is:<br /><br /><blockquote><blockquote>DEBUG 30 Aug 2011 19:25:25 SomeImapClient:32 - Getting session</blockquote><blockquote>DEBUG 30 Aug 2011 19:25:25 SomeImapClient:38 - getting the session for accessing email.</blockquote><blockquote>DEBUG 30 Aug 2011 19:25:25 SomeImapClient:42 - Connection established with IMAP server.</blockquote><blockquote>DEBUG 30 Aug 2011 19:25:25 SomeImapClient:55 - Some Subject</blockquote><blockquote><br /></blockquote></blockquote><br />Some small gotchas:<br /><br /><ul><li>your store.connect(&#8220;example.com&#8221;, &#8220;username&#8221;, &#8220;anything&#8221;) must match your &#8220;username@example.com&#8221; addressee in msg.setRecipients; different addressees will yield multiple mailboxes.</li>
 <li>Only works for plain imap &amp; pop3 mailboxes. Even though it doesn&#8217;t make a lot of sense to use SSL on a mock mailbox, if you try getting the &#8220;imaps&#8221; store you&#8217;ll get an error as a real implementation of javamail will be employed.</li>
 <li>I&#8217;d always advise to use such tearDown() when doing unit tests, since the Session seems global and different tests could interfere with different contents - unless you use a different fake user/test server url in each of your tests.</li>
 </ul><br /><br /><br /></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Craig Doremus</div>
<div class='content'>
Where&#39;s the rest of the IMAPMailRepositoryTest class with the test methods and assertions?!?</div>
</div>
</div>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/5/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/08/28/this-blog-is-moving/">This Blog Is Moving</a>
      </li>
    
      <li class="post">
        <a href="/2014/02/09/python-packaging-woes-part-3/">Python Packaging Woes - Part 3</a>
      </li>
    
      <li class="post">
        <a href="/2013/09/06/python-packaging-woes-2/">Python Packaging Woes - Part 2</a>
      </li>
    
      <li class="post">
        <a href="/2013/08/26/one-assertion-per-test-considered-ambiguous/">One Assertion Per Test Considered Ambiguous</a>
      </li>
    
      <li class="post">
        <a href="/2013/01/21/python-packaging-woes/">Python Packaging Woes - Part 1</a>
      </li>
    
  </ul>
</section>




<section>
  <h1>Latest Tweets</h1>
  <a class="twitter-timeline" href="https://twitter.com/franzeur" data-widget-id="361445337954672640">Tweets by @franzeur</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Alan Franzoni -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'ollivander';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
